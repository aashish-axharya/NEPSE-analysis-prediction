{% extends "base.html" %}
{% block title %}Analysis{% endblock %}
{% block content %}

<div class="container">
    <h1>Analysis</h1>
    <form method="POST" class="form-inline">
        {% csrf_token %}
        <label for="stock">Select Stock:</label>
        <select class="form-control" name="stock" onchange="this.form.submit()">
            {% for stock in stock_names %}
            <option value="{{ stock }}" {% if selected_stock == stock %} selected {% endif %}>{{ stock }}</option>
            {% endfor %}
          </select>
    </form>
    
    <div class="card">
        <div class="card-body">
            <div id="ma_graph">
                {{ ma_graph|safe }}
            </div>
        </div>
        <div class="card-body">
            <div id="rsi_graph">
                {{ rsi_graph|safe }}
            </div>
        </div>
    </div>
</div>

<script>
    // Listen for form submission
    document.querySelector('form[name="stock-form"]').addEventListener('submit', function(event) {
      event.preventDefault(); // Prevent the form from submitting normally
  
      // Get the selected option value
      const selectedStock = document.querySelector('select[name="stock"]').value;
  
      // Set the value attribute of the select element to the selected option
      document.querySelector('select[name="stock"]').value = selectedStock;
    });
  </script>
{% endblock %}